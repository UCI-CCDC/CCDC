# auditd rules

# log all changes to /etc/passwd
-w /etc/passwd -p wa -k passwd_changes
# log executions of insmod, which allow insertion of modules into kernel
-w /sbin/insmod -p x -k module_insertion

# log any file deletion/rename by user with uid > 500
-a always,exit -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete

# removed "-F auid=1000" parameter after always, used to specify EUID of user executing program
-a exit,always  -F egid!=994 -F auid!=-1 -F arch=b32 -S execve -k audit-wazuh-c
-a exit,always  -F egid!=994 -F auid!=-1 -F arch=b64 -S execve -k audit-wazuh-c

